<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
    <title>进程情况</title>
    <script src="/static/extlib/jquery.js"></script>
    <script type="text/javascript" src="/static/extlib/echarts.min.js"></script>
    <script type="text/javascript" src="/static/charts.js"></script>
    <script type="text/javascript" src="/static/script.js"></script>
    <script type="text/javascript" src="/static/progress_bar.js"></script>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename="task_page.css") }}"/>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='style.css') }}"/>
</head>

<script>
    $(function () {
        start_task("{{ pid }}")
    })
</script>

<body>
<div class="headerpage"></div>
<p><input type="button" value="回到主页面" onclick="window.location.href='/'"></p>
<h2>
    优化过程-{{ pid }}（
    {% if finished == 100 %}
        已结束
    {% else %}
        运行中
    {% endif %}
    ）
</h2>
<div>
    <div style="float:left;width:45%;margin-right: 10%">
        <div class="cfg">
            <h4>数据集名称：{{ view.dataname }}</h4>
            <h4>敏感属性：
                {% for fear in cfg.sens_featrs %}
                    {{ fear }},
                {% endfor %}
            </h4>
            <h4>优化目标：{{ cfg.acc_metric }}, {{ cfg.fair_metric }}</h4>
            <h4>种群大小：{{ cfg.pop_size }}</h4>
            <h4>演化代数：{{ cfg.max_gens }}</h4>
            <h4>优化器：{{ cfg.optimizer }}</h4>
        </div>

        <div class="poptable">
            <table>
                <tr>
                    {#                <th></th>#}
                    <th id="th_id">ID</th>
                    <th id="th_acc">{{ cfg.acc_metric }}</th>
                    <th id="th_fair">{{ cfg.fair_metric }}</th>
                </tr>
                <tbody id="poptext">
                {% for fpop in fpops %}
                    <tr>
                        {#                    <td><label>#}
                        {#                        <input type="checkbox" name="slct{{ i }}" checked>#}
                        {#                    </label></td>#}
                        <td>{{ loop.index }}</td>
                        <td>{{ fpop[0] }}</td>
                        <td>{{ fpop[1] }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

    </div>
    <div class="block" style="float:left;width:45%">
        <div style="text-align: center;"><h3>公平性指标和准确性指标优化结果</h3></div>
        <div id="{{ pid }}" style="width:500px; height:500px; text-align: center">
            <script> get_chart("{{ pid }}", "http://127.0.0.1:{{ port }}/task/{{ pid }}/chart") </script>
        </div>
    </div>
</div>

<div id="btns" style="float:bottom;width:50%">
    {% if not finished %}
        <p>
            <input type="submit" value="终止任务">
        </p>
    {% endif %}
    <p>
        {% if not finished %}
            <input type="submit" value="上传模型" onclick="uploadModels()">
        {% endif %}
        <input type="submit" value="下载模型" onclick="downloadModels()">
    </p>
</div>

<div class="progress-div">
    <div class="progress">
        <h4 id="prog_info" style="text-align: center"></h4>
        <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0"
             aria-valuemax="100" style="min-width: 2em; width: 2%;">
        </div>
    </div>
</div>

<div class="footerpage" style="float:bottom"></div>
<script src="{{ url_for('static',filename='extlib/jquery.js') }}"></script>
<script>
    $(function () {
        $(".headerpage").load("{{url_for('static',filename='header.html')}}");
        $(".footerpage").load("{{url_for('static',filename='footer.html')}}");
    });
</script>
</body>
</html>
