<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
    <title>{{ _("task_status") }}</title>
    <script src="/static/extlib/jquery.js"></script>
    <script type="text/javascript" src="/static/extlib/echarts.min.js"></script>
    <script type="text/javascript" src="/static/charts.js"></script>
    <script type="text/javascript" src="/static/script.js"></script>
    <script type="text/javascript" src="/static/progress_bar.js"></script>
    <script src="{{ url_for("babel_catalog") }}"></script>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename="task_page.css") }}"/>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='style.css') }}"/>
</head>

<script>
    $(function () {
        start_task("{{ pid }}")
    })
</script>

<body>
<div class="headerpage"></div>
<p><input type="button" value="{{ _("back") }}" onclick="window.location.href='/'"></p>
<h2>
    {{ _("optimization_process") }}-{{ pid }}（
    {% if status == 11 %}
        {{ _("task_end") }}
    {% else %}
        {{ _("task_running") }}
    {% endif %}
    ）
</h2>
<div style="width: 100%">
    <div style="float:left;width:500px;margin-right: 150px">
        <div class="cfg">
            <h4>{{ _("dataset_name") }}: {{ view.dataname }}</h4>
            <h4>{{ _("sensitive_attributes") }}:
                {% for fear in cfg.sens_featrs %}
                    {{ fear }},
                {% endfor %}
            </h4>
            <h4>{{ _("optimization_obj") }}: {{ cfg.acc_metric }}, {{ cfg.fair_metric }}</h4>
            <h4>{{ _("pop_size") }}: {{ cfg.pop_size }}</h4>
            <h4>{{ _("iter_time") }}: {{ cfg.max_gens }}</h4>
            <h4>{{ _("mo_optimazor") }}: {{ cfg.optimizer }}</h4>
        </div>

        <div class="poptable" style="width: 500px">
            <table>
                <tr>
                    {#                <th></th>#}
                    <th id="th_id">ID</th>
                    <th id="th_acc">{{ cfg.acc_metric }}</th>
                    <th id="th_fair">{{ cfg.fair_metric }}</th>
                </tr>
                <tbody id="poptext">
                {% for fpop in fpops %}
                    <tr>
                        {#                    <td><label>#}
                        {#                        <input type="checkbox" name="slct{{ i }}" checked>#}
                        {#                    </label></td>#}
                        <td>{{ loop.index }}</td>
                        <td>{{ fpop[0] }}</td>
                        <td>{{ fpop[1] }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="block" style="float:left">
        <h3>{{ _("optimization_result") }}</h3>
        <div id="{{ pid }}" style="width:500px; height:500px; text-align: center">
            <script> get_chart("{{ pid }}", "http://{{ url }}/task/{{ pid }}/chart") </script>
        </div>
    </div>
</div>

<div id="btns" style="float:left;width:100%">
    {% if status != 11 %}
    <p>
        <input id="abort" type="submit" value="{{ _("task_stop") }}" onclick="killProcess('http://{{ url }}/task/{{ pid }}/intervene')">
        <input id="pause" type="submit" value="{{ _("task_pause") }}" onclick="pauseContinue('http://{{ url }}/task/{{ pid }}/pause')">
    </p>
    {% endif %}
    <p>
        <a href="/task/{{ pid }}/download_model" id="download_model" hidden="hidden">{{ _("download_models") }}</a>
    </p>
</div>

<div class="progress-div" style="float:left;width: 1200px">
    <div class="progress">
        <h4 id="prog_info" style="text-align: center"></h4>
        <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0"
             aria-valuemax="100" style="min-width: 2em; width: 2%;">
        </div>
    </div>
</div>

<div class="footerpage" style="float:left;width: 100%"></div>
<script src="{{ url_for('static',filename='extlib/jquery.js') }}"></script>
<script>
    $(function () {
        $(".headerpage").load("{{ url_for('loadheader', para="hidden") }}");
        $(".footerpage").load("{{ url_for('loadfooter') }}");
    });
</script>
</body>
</html>
